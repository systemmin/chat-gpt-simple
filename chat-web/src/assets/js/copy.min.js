function opyToClipboard(text) {
	var input = document.createElement("textarea");
	input.value = text;
	document.body.appendChild(input);
	input.select();
	document.execCommand("copy");
	document.body.removeChild(input);
}
export default class CopyButtonPlugin {
	constructor(options = {}) {
		self.hook = options.hook;
		self.callback = options.callback;
		self.lang = options.lang || document.documentElement.lang || "en"
	}

	'before:highlightElement'({
		el,
		language,
	}) {
		el.parentElement.style.position = 'relative';
		el.style.paddingTop = '40px';
		let div = Object.assign(document.createElement("div"), {
			className: "hljs-custom-copy"
		});
		const left = document.createElement("div")
		const span = document.createElement("span")
		span.innerText = language?language:'ssh';
		left.style.textIndent="10px"
		left.append(span)
		div.append(left)
		const right = document.createElement("div")
		right.className='hljs-custom-copy-icon';
		div.appendChild(right)
		el.parentElement.appendChild(div);
		right.onclick = function() {
			opyToClipboard(el.innerText);
			right.style.width='8rem';
			right.innerHTML='已复制';
			setTimeout(()=>{
				right.style.width='2rem';
				right.innerHTML='';
			},1000)
		}
	}
}

